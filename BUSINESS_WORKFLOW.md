# Product Warehouse - ä¸šåŠ¡æµç¨‹å’Œæ•°æ®ç®¡ç†æ–¹æ¡ˆ

## ğŸ¯ æ ¸å¿ƒé—®é¢˜è§£ç­”

### é—®é¢˜ 1: è®¢å•çŠ¶æ€å¦‚ä½•ç®¡ç†ï¼Ÿ

**ç­”æ¡ˆ**ï¼šé€šè¿‡ç½‘ç«™ç•Œé¢æ‰‹åŠ¨æ›´æ–° + è‡ªåŠ¨è§„åˆ™

#### è®¢å•çŠ¶æ€æµè½¬

```
åˆ›å»ºè®¢å•
    â†“
[pending] å¾…å¤„ç†
    â†“ (ä»“åº“äººå‘˜ç‚¹å‡»"å¼€å§‹å¤„ç†")
[processing] å¤„ç†ä¸­
    â†“ (ä»“åº“äººå‘˜ç‚¹å‡»"æ ‡è®°å·²å‘è´§")
[shipped] å·²å‘è´§
    â†“ (ç³»ç»Ÿè‡ªåŠ¨æˆ–æ‰‹åŠ¨ç¡®è®¤)
[completed] å·²å®Œæˆ

(ä»»ä½•çŠ¶æ€éƒ½å¯ä»¥) â†’ [cancelled] å·²å–æ¶ˆ
```

#### å®ç°æ–¹å¼

1. **åç«¯ API**ï¼š
   ```
   PUT /api/v1/orders/{order_id}/status
   Body: { "status": "processing", "notes": "å¼€å§‹æ‹£è´§" }
   ```

2. **å‰ç«¯ç•Œé¢**ï¼š
   - è®¢å•åˆ—è¡¨é¡µé¢ï¼šæ˜¾ç¤ºæ‰€æœ‰è®¢å•åŠå…¶çŠ¶æ€
   - è®¢å•è¯¦æƒ…é¡µé¢ï¼šå¯ä»¥æ›´æ–°è®¢å•çŠ¶æ€
   - çŠ¶æ€æŒ‰é’®ï¼šåªæ˜¾ç¤ºå…è®¸çš„ä¸‹ä¸€æ­¥çŠ¶æ€

3. **æƒé™æ§åˆ¶**ï¼š
   - æ™®é€šå‘˜å·¥ï¼šåªèƒ½æŸ¥çœ‹
   - ä»“åº“ç®¡ç†å‘˜ï¼šå¯ä»¥æ›´æ–°çŠ¶æ€
   - è¶…çº§ç®¡ç†å‘˜ï¼šæ‰€æœ‰æƒé™

---

### é—®é¢˜ 2: æ˜¯å¦éœ€è¦ä¸¤ä¸ªæ•°æ®åº“ï¼Ÿ

**ç­”æ¡ˆ**ï¼šä¸éœ€è¦ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡åŒºåˆ†å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒ

#### æ•°æ®åº“é…ç½®æ–¹æ¡ˆ

```
å¼€å‘ç¯å¢ƒ (.env æˆ– .env.development)
â”œâ”€â”€ æ•°æ®åº“ï¼šæœ¬åœ° SQLite (warehouse_dev.db)
â”œâ”€â”€ æ•°æ®ï¼šæµ‹è¯•æ•°æ®ï¼ˆç§å­æ•°æ®ï¼‰
â””â”€â”€ ç›®çš„ï¼šå¼€å‘å’Œæµ‹è¯•åŠŸèƒ½

ç”Ÿäº§ç¯å¢ƒ (.env.production)
â”œâ”€â”€ æ•°æ®åº“ï¼šé˜¿é‡Œäº‘ RDS MySQL
â”œâ”€â”€ æ•°æ®ï¼šçœŸå®ä¸šåŠ¡æ•°æ®
â””â”€â”€ ç›®çš„ï¼šå®é™…è¿è¥
```

#### ç¯å¢ƒåˆ‡æ¢

```python
# config.py
import os
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    # æ ¹æ®ç¯å¢ƒå˜é‡è‡ªåŠ¨é€‰æ‹©æ•°æ®åº“
    DATABASE_URL: str = os.getenv(
        "DATABASE_URL",
        "sqlite:///./warehouse_dev.db"  # å¼€å‘ç¯å¢ƒé»˜è®¤
    )
    
    class Config:
        env_file = ".env"

# ç”Ÿäº§ç¯å¢ƒ
# DATABASE_URL=mysql+pymysql://user:pass@rds.aliyuncs.com:3306/warehouse
```

---

### é—®é¢˜ 3: å¦‚ä½•åœ¨ç½‘ç«™ä¸Šæ›´æ”¹è®¢å•çŠ¶æ€å’Œæ•°é‡ï¼Ÿ

**ç­”æ¡ˆ**ï¼šåˆ›å»ºç®¡ç†é¡µé¢ + API ç«¯ç‚¹

#### éœ€è¦æ·»åŠ çš„åŠŸèƒ½

##### A. è®¢å•ç®¡ç†é¡µé¢ (Orders Management)

**åŠŸèƒ½**ï¼š
- ğŸ“‹ è®¢å•åˆ—è¡¨ï¼ˆå¸¦ç­›é€‰ï¼šçŠ¶æ€ã€æ—¥æœŸã€ç»é”€å•†ï¼‰
- ğŸ” æœç´¢è®¢å•ï¼ˆè®¢å•å·ã€äº§å“åï¼‰
- âœï¸ ç¼–è¾‘è®¢å•ï¼ˆä¿®æ”¹æ•°é‡ã€çŠ¶æ€ï¼‰
- ğŸ—‘ï¸ å–æ¶ˆè®¢å•
- ğŸ“Š è®¢å•è¯¦æƒ…ï¼ˆæ˜¾ç¤ºå®Œæ•´ä¿¡æ¯ï¼‰

**ç•Œé¢ç¤ºä¾‹**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¢å•ç®¡ç†                          [+ æ–°å»ºè®¢å•] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç­›é€‰: [çŠ¶æ€: å…¨éƒ¨ â–¼] [æ—¥æœŸèŒƒå›´] [æœç´¢...]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®¢å•å·      | äº§å“    | æ•°é‡ | çŠ¶æ€    | æ“ä½œ â”‚
â”‚ WH-2024-001 | æ´»å¡ç»„  | 100  | pending | [ç¼–è¾‘]â”‚
â”‚ WH-2024-002 | æœºæ²¹    | 50   | shipped | [æŸ¥çœ‹]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### B. åº“å­˜ç®¡ç†é¡µé¢ (Inventory Management)

**åŠŸèƒ½**ï¼š
- ğŸ“¦ åº“å­˜åˆ—è¡¨ï¼ˆæŒ‰ä»“åº“ã€äº§å“ï¼‰
- â• å…¥åº“æ“ä½œ
- â– å‡ºåº“æ“ä½œ
- ğŸ”„ è°ƒæ•´åº“å­˜
- ğŸ“ˆ åº“å­˜å†å²

**ç•Œé¢ç¤ºä¾‹**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº“å­˜ç®¡ç†                          [+ åº“å­˜è°ƒæ•´] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ äº§å“      | ä»“åº“   | å¯ç”¨ | é¢„ç•™ | æ“ä½œ       â”‚
â”‚ æ´»å¡ç»„    | ä¸»ä»“åº“ | 150  | 20   | [è°ƒæ•´][å†å²]â”‚
â”‚ æœºæ²¹ 5W30 | ä¸»ä»“åº“ | 500  | 0    | [è°ƒæ•´][å†å²]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ å®ç°æ­¥éª¤

### æ­¥éª¤ 1: æ›´æ–°æ•°æ®åº“æ¨¡å‹

æ·»åŠ å¿…è¦å­—æ®µï¼ˆå·²åœ¨ DATABASE_SCHEMA.md ä¸­è®¾è®¡ï¼‰

### æ­¥éª¤ 2: åˆ›å»ºåç«¯ API

#### è®¢å•ç®¡ç† API

```python
# æ›´æ–°è®¢å•çŠ¶æ€
PUT /api/v1/orders/{order_id}/status
{
  "status": "processing",
  "notes": "å¼€å§‹å¤„ç†è®¢å•"
}

# æ›´æ–°è®¢å•æ•°é‡
PUT /api/v1/orders/{order_id}
{
  "quantity": 150,
  "notes": "å®¢æˆ·è¦æ±‚å¢åŠ æ•°é‡"
}

# è·å–è®¢å•å†å²
GET /api/v1/orders/{order_id}/history
```

#### åº“å­˜ç®¡ç† API

```python
# è°ƒæ•´åº“å­˜
POST /api/v1/inventory/adjust
{
  "product_id": 1,
  "warehouse_id": 1,
  "quantity": 100,
  "transaction_type": "IN",  # IN, OUT, ADJUST
  "notes": "æ–°åˆ°è´§"
}

# è·å–åº“å­˜å†å²
GET /api/v1/inventory/{product_id}/transactions
```

### æ­¥éª¤ 3: åˆ›å»ºå‰ç«¯ç®¡ç†é¡µé¢

1. **è®¢å•ç®¡ç†é¡µé¢** (`src/pages/OrderManagement.tsx`)
2. **åº“å­˜ç®¡ç†é¡µé¢** (`src/pages/InventoryManagement.tsx`)
3. **æ·»åŠ åˆ°è·¯ç”±** (`src/App.tsx`)

### æ­¥éª¤ 4: æƒé™æ§åˆ¶

```python
# è£…é¥°å™¨ç¤ºä¾‹
@router.put("/orders/{order_id}/status")
async def update_order_status(
    order_id: int,
    status_update: OrderStatusUpdate,
    current_user: User = Depends(get_current_active_user),
    db: Session = Depends(get_db)
):
    # æ£€æŸ¥æƒé™
    if not current_user.role in ["manager", "admin"]:
        raise HTTPException(403, "æ— æƒé™")
    
    # æ›´æ–°è®¢å•çŠ¶æ€
    order = db.query(SalesOrder).filter(SalesOrder.id == order_id).first()
    if not order:
        raise HTTPException(404, "è®¢å•ä¸å­˜åœ¨")
    
    order.status = status_update.status
    # è®°å½•æ´»åŠ¨æ—¥å¿—
    log = ActivityLog(
        activity_type="order",
        action=f"è®¢å•çŠ¶æ€æ›´æ–°ä¸º {status_update.status}",
        item_name=order.order_code,
        user_id=current_user.id
    )
    db.add(log)
    db.commit()
    
    return order
```

### æ­¥éª¤ 5: ç§å­æ•°æ®ï¼ˆå¼€å‘ç”¨ï¼‰

åˆ›å»ºè„šæœ¬ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼š

```python
# scripts/seed_data.py
def create_seed_data(db: Session):
    """åˆ›å»ºæµ‹è¯•æ•°æ®"""
    
    # 1. åˆ›å»ºç”¨æˆ·
    admin = User(
        username="admin",
        email="admin@warehouse.com",
        phone="13800138000",
        hashed_password=get_password_hash("admin123"),
        role="admin"
    )
    
    # 2. åˆ›å»ºäº§å“åˆ†ç±»
    category = ProductCategory(
        name="å‘åŠ¨æœºé›¶ä»¶",
        code="ENGINE_PARTS"
    )
    
    # 3. åˆ›å»ºäº§å“
    product = Product(
        name="6BT æ´»å¡ç»„",
        sku="PISTON-6BT-001",
        part_number="3803682",
        engine_model="6BT5.9",
        price=850.00,
        category_id=category.id
    )
    
    # 4. åˆ›å»ºä»“åº“
    warehouse = Warehouse(
        name="ä¸»ä»“åº“",
        code="WH001",
        capacity=1000.0
    )
    
    # 5. åˆ›å»ºåº“å­˜
    inventory = Inventory(
        product_id=product.id,
        warehouse_id=warehouse.id,
        quantity=100
    )
    
    db.add_all([admin, category, product, warehouse, inventory])
    db.commit()
```

---

## ğŸ“ å»ºè®®çš„å®ç°é¡ºåº

### é˜¶æ®µ 1: æ•°æ®åº“å’ŒåŸºç¡€ APIï¼ˆä¼˜å…ˆï¼‰
1. âœ… æ›´æ–°æ•°æ®åº“æ¨¡å‹ï¼ˆæ·»åŠ æ–°å­—æ®µï¼‰
2. âœ… åˆ›å»º ActivityLog æ¨¡å‹
3. âœ… åˆ›å»ºè®¢å•ç®¡ç† API
4. âœ… åˆ›å»ºåº“å­˜ç®¡ç† API
5. âœ… åˆ›å»º Dashboard API

### é˜¶æ®µ 2: å‰ç«¯ç•Œé¢
6. âœ… æ›´æ–° Dashboardï¼ˆè°ƒç”¨çœŸå® APIï¼‰
7. âœ… åˆ›å»ºè®¢å•ç®¡ç†é¡µé¢
8. âœ… åˆ›å»ºåº“å­˜ç®¡ç†é¡µé¢
9. âœ… æ·»åŠ æƒé™æ§åˆ¶

### é˜¶æ®µ 3: æµ‹è¯•å’Œä¼˜åŒ–
10. âœ… åˆ›å»ºç§å­æ•°æ®è„šæœ¬
11. âœ… æµ‹è¯•å®Œæ•´æµç¨‹
12. âœ… ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

---

## ğŸ¯ ç”¨æˆ·è§’è‰²å’Œæƒé™

| è§’è‰² | æŸ¥çœ‹ | åˆ›å»ºè®¢å• | æ›´æ–°è®¢å•çŠ¶æ€ | è°ƒæ•´åº“å­˜ | ç”¨æˆ·ç®¡ç† |
|------|------|----------|--------------|----------|----------|
| **å‘˜å·¥ (staff)** | âœ… | âœ… | âŒ | âŒ | âŒ |
| **ä»“åº“ç®¡ç†å‘˜ (manager)** | âœ… | âœ… | âœ… | âœ… | âŒ |
| **ç³»ç»Ÿç®¡ç†å‘˜ (admin)** | âœ… | âœ… | âœ… | âœ… | âœ… |

---

## ğŸ’¾ æ•°æ®å¤‡ä»½ç­–ç•¥

**å¼€å‘ç¯å¢ƒ**ï¼š
- SQLite æ–‡ä»¶å®šæœŸå¤‡ä»½
- å¯ä»¥éšæ—¶é‡ç½®å¹¶é‡æ–°ç”Ÿæˆç§å­æ•°æ®

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
- é˜¿é‡Œäº‘ RDS è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰
- æ‰‹åŠ¨å¤‡ä»½ï¼ˆé‡è¦æ“ä½œå‰ï¼‰
- å¯¼å‡ºé‡è¦æ•°æ®åˆ° Excel

---

**æœ€åæ›´æ–°**: 2025-11-10
